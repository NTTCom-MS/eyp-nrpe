
module nrpe_monit 1.0.5;

require {
	type user_tmp_t;
	type home_root_t;
	type var_t;
	type tmp_t;
	type auditd_log_t;
	type usr_t;
	type boot_t;
	type nagios_etc_t;
	type var_log_t;
	type device_t;
	type root_t;
	type nrpe_t;
	type sudo_exec_t;
	type tmpfs_t;
	type mount_exec_t;
	type nfs_t;
	class capability { audit_write dac_override };
	class file { create execute execute_no_trans getattr open read unlink write };
	class dir { add_name getattr open read remove_name search write };
	class netlink_audit_socket { create nlmsg_relay };
}

#============= nrpe_t ==============
allow nrpe_t mount_exec_t:file { execute_no_trans open getattr execute read };
allow nrpe_t nfs_t:dir { add_name open write getattr read search };
allow nrpe_t nfs_t:file { open read create getattr };


allow nrpe_t auditd_log_t:dir search;

#!!!! This avc is allowed in the current policy
allow nrpe_t auditd_log_t:dir { add_name getattr open read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t auditd_log_t:file { create getattr open unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t boot_t:dir { add_name remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t boot_t:file { create unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t device_t:dir { add_name remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t device_t:file { create getattr open unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t home_root_t:dir { add_name read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t home_root_t:file { create getattr open unlink write };
allow nrpe_t nagios_etc_t:dir read;
allow nrpe_t nagios_etc_t:file { getattr open read };

#!!!! This avc is allowed in the current policy
allow nrpe_t root_t:dir { add_name remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t root_t:file { create getattr open unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t self:capability audit_write;
allow nrpe_t self:capability dac_override;

#!!!! This avc is allowed in the current policy
allow nrpe_t self:netlink_audit_socket { create nlmsg_relay };

#!!!! This avc is allowed in the current policy
allow nrpe_t sudo_exec_t:file { execute execute_no_trans getattr open read };
allow nrpe_t tmp_t:dir { add_name read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t tmp_t:file { create open unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t tmpfs_t:dir { add_name read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t tmpfs_t:file { create getattr open read unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t user_tmp_t:dir { add_name read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t user_tmp_t:file { create open unlink };

#!!!! This avc is allowed in the current policy
allow nrpe_t usr_t:dir { add_name remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t usr_t:file { create unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t var_log_t:dir { add_name read remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t var_log_t:file { create open unlink write };

#!!!! This avc is allowed in the current policy
allow nrpe_t var_t:dir { add_name remove_name write };

#!!!! This avc is allowed in the current policy
allow nrpe_t var_t:file { create getattr open unlink write };
